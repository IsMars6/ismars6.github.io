var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{d as r,c as o,s as n,aG as i,a as d,a5 as u,G as c,f as m,C as p,z as h,aB as f,u as v,h as j,e as k,m as g,l as y,I as x,O as _}from"./index-IQGo8WxO.js";import{E as b}from"./index-CAywqtFc.js";import{E as C}from"./index-Sk3Tdu_Z.js";import{E}from"./index-BKGyGajh.js";import{E as V}from"./index-DlgK5ZY7.js";import{_ as O}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./error-D_Dr4eZ1.js";import"./index-Bi9RLQBv.js";import"./token-DWNpOE8r.js";import"./index-CXRd8D_e.js";import"./index-6fZG0U-_.js";import"./event-BwRzfsZt.js";import"./use-form-common-props-AkxMGj96.js";import"./use-form-item-M_69vDeD.js";import"./index-CId84KWp.js";import"./isEqual-DovbVL_y.js";import"./_Uint8Array-C6UxRYqY.js";import"./index-BI2hd7RK.js";import"./index-ClZ4RRhL.js";import"./vnode-CPGJC5yZ.js";import"./scroll-CpQYakkq.js";import"./index-CVDCfo3G.js";import"./aria-BWz5Vf1b.js";import"./use-dialog-HEYsGeDR.js";import"./index-DyKybXYc.js";import"./refs-B-58sHkE.js";const K={style:{display:"flex","align-items":"center"}},w={key:0},L={key:1},M={class:"dialog-footer"},$=O(r({__name:"role-permission-dialog",props:{modelValue:{type:Boolean,default:!1},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:r}){const O=e,$=r,A=o({get:()=>O.modelValue,set:e=>$("update:modelValue",e)}),{menuList:I}=n(i()),D=d(),G=d(!0),H=d(!1),N=o((()=>{const e=r=>{const o=((e,r)=>{for(var o in r||(r={}))a.call(r,o)&&l(e,o,r[o]);if(t)for(var o of t(r))s.call(r,o)&&l(e,o,r[o]);return e})({},r);if(r.meta&&r.meta.authList&&r.meta.authList.length){const e=r.meta.authList.map((e=>({id:`${r.id}_${e.authMark}`,name:`${r.name}_${e.authMark}`,label:e.title,authMark:e.authMark,isAuth:!0,checked:e.checked||!1})));o.children=o.children?[...o.children,...e]:e}return o.children&&(o.children=o.children.map(e)),o};return I.value.map(e)})),P={children:"children",label:e=>{var t;return f(null==(t=e.meta)?void 0:t.title)||""}};u((()=>O.modelValue),(e=>{e&&O.roleData}));const z=()=>{var e;A.value=!1,null==(e=D.value)||e.setCheckedKeys([])},B=()=>{_.success("权限保存成功"),$("success"),z()},S=()=>{const e=D.value;if(!e)return;const t=e.store.nodesMap;Object.values(t).forEach((e=>{e.expanded=!G.value})),G.value=!G.value},U=()=>{const e=D.value;if(e){if(H.value)e.setCheckedKeys([]);else{const t=q(N.value);e.setCheckedKeys(t)}H.value=!H.value}},q=e=>{const t=[],a=e=>{e.forEach((e=>{e.name&&t.push(e.name),e.children&&e.children.length>0&&a(e.children)}))};return a(e),t},F=()=>{const e=D.value;if(!e)return;const t=e.getCheckedKeys(),a=q(N.value);H.value=t.length===a.length&&a.length>0},J=()=>{const e=D.value;if(!e)return;const t=e.getCheckedKeys(),a=e.getHalfCheckedKeys();e.getCheckedNodes(),e.getHalfCheckedNodes(),t.length,a.length;_.success(`已输出选中数据到控制台，共选中 ${t.length} 个节点`)};return(e,t)=>{const a=C,s=b,l=E,r=V;return m(),c(r,{modelValue:v(A),"onUpdate:modelValue":t[0]||(t[0]=e=>x(A)?A.value=e:null),title:"菜单权限",width:"520px","align-center":"",class:"el-dialog-border",onClose:z},{footer:p((()=>[j("div",M,[h(l,{onClick:J,style:{"margin-left":"8px"}},{default:p((()=>t[1]||(t[1]=[y("获取选中数据")]))),_:1,__:[1]}),h(l,{onClick:S},{default:p((()=>[y(g(v(G)?"全部收起":"全部展开"),1)])),_:1}),h(l,{onClick:U,style:{"margin-left":"8px"}},{default:p((()=>[y(g(v(H)?"取消全选":"全部选择"),1)])),_:1}),h(l,{type:"primary",onClick:B},{default:p((()=>t[2]||(t[2]=[y("保存")]))),_:1,__:[2]})])])),default:p((()=>[h(s,{height:"70vh"},{default:p((()=>[h(a,{ref_key:"treeRef",ref:D,data:v(N),"show-checkbox":"","node-key":"name","default-expand-all":v(G),"default-checked-keys":[1,2,3],props:P,onCheck:F},{default:p((({data:e})=>[j("div",K,[e.isAuth?(m(),k("span",w,g(e.label),1)):(m(),k("span",L,g(P.label(e)),1))])])),_:1},8,["data","default-expand-all"])])),_:1})])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-d9ac0505"]]);export{$ as default};
