import{R as e}from"./formData-BXYWt-zH.js";import{a,E as l}from"./index-DvdSgfWH.js";import{E as r}from"./index-lwuhUFm2.js";import{E as s,a as o}from"./index-WiBceMwr.js";import{E as t}from"./index-BKGyGajh.js";import{E as u}from"./index-DlgK5ZY7.js";import{d,a as n,c as i,r as m,a5 as p,n as g,G as f,f as v,C as b,z as c,u as _,e as y,F as V,D as h,h as x,l as j,I as D,O as w}from"./index-IQGo8WxO.js";const C={class:"dialog-footer"},E=d({__name:"user-dialog",props:{visible:{type:Boolean},type:{},userData:{}},emits:["update:visible","submit"],setup(d,{emit:E}){const U=d,k=E,q=n(e),R=i({get:()=>U.visible,set:e=>k("update:visible",e)}),A=i((()=>U.type)),P=n(),G=m({username:"",phone:"",gender:"男",role:[]}),N={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"blur"}]};p((()=>[U.visible,U.type,U.userData]),(([e])=>{e&&((()=>{const e="edit"===U.type&&U.userData,a=U.userData;Object.assign(G,{username:e&&a.userName||"",phone:e&&a.userPhone||"",gender:e&&a.userGender||"男",role:e&&Array.isArray(a.userRoles)?a.userRoles:[]})})(),g((()=>{var e;null==(e=P.value)||e.clearValidate()})))}),{immediate:!0});const O=()=>{return e=this,a=null,l=function*(){P.value&&(yield P.value.validate((e=>{e&&(w.success("add"===A.value?"添加成功":"更新成功"),R.value=!1,k("submit"))})))},new Promise(((r,s)=>{var o=e=>{try{u(l.next(e))}catch(a){s(a)}},t=e=>{try{u(l.throw(e))}catch(a){s(a)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,t);u((l=l.apply(e,a)).next())}));var e,a,l};return(e,d)=>{const n=r,i=l,m=o,p=s,g=a,w=t,E=u;return v(),f(E,{modelValue:_(R),"onUpdate:modelValue":d[5]||(d[5]=e=>D(R)?R.value=e:null),title:"add"===_(A)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:b((()=>[x("div",C,[c(w,{onClick:d[4]||(d[4]=e=>R.value=!1)},{default:b((()=>d[6]||(d[6]=[j("取消")]))),_:1,__:[6]}),c(w,{type:"primary",onClick:O},{default:b((()=>d[7]||(d[7]=[j("提交")]))),_:1,__:[7]})])])),default:b((()=>[c(g,{ref_key:"formRef",ref:P,model:_(G),rules:N,"label-width":"80px"},{default:b((()=>[c(i,{label:"用户名",prop:"username"},{default:b((()=>[c(n,{modelValue:_(G).username,"onUpdate:modelValue":d[0]||(d[0]=e=>_(G).username=e)},null,8,["modelValue"])])),_:1}),c(i,{label:"手机号",prop:"phone"},{default:b((()=>[c(n,{modelValue:_(G).phone,"onUpdate:modelValue":d[1]||(d[1]=e=>_(G).phone=e)},null,8,["modelValue"])])),_:1}),c(i,{label:"性别",prop:"gender"},{default:b((()=>[c(p,{modelValue:_(G).gender,"onUpdate:modelValue":d[2]||(d[2]=e=>_(G).gender=e)},{default:b((()=>[c(m,{label:"男",value:"男"}),c(m,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),c(i,{label:"角色",prop:"role"},{default:b((()=>[c(p,{modelValue:_(G).role,"onUpdate:modelValue":d[3]||(d[3]=e=>_(G).role=e),multiple:""},{default:b((()=>[(v(!0),y(V,null,h(_(q),(e=>(v(),f(m,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])}}});export{E as _};
