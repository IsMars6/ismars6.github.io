var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r;import{d as t,p as i,v as c,a as u,c as d,e as p,f as v,h as m,z as f,C as y,m as _,l as h,k as b,F as w,D as j,G as k,i as R,L as g,M as N,O as E}from"./index-IQGo8WxO.js";import{E as P}from"./index-CE6ES6Vp.js";import{E as x}from"./index-BSQc1V3V.js";import{E as O}from"./index-BKGyGajh.js";import{_ as S}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./use-form-common-props-AkxMGj96.js";import"./index-BI2hd7RK.js";import"./use-form-item-M_69vDeD.js";import"./index-CId84KWp.js";const U={class:"switch-role-page"},A={class:"current-user-card"},I={class:"user-info"},C={class:"user-details"},D={class:"info-item"},M={class:"value"},T={class:"info-item"},F={class:"info-item"},z={class:"buttons-list"},G={key:0,class:"no-data"},L={class:"role-switch-section"},H={class:"role-buttons"},X={class:"role-info"},q={class:"role-details"},B={class:"role-meta"},J={class:"role-actions"},K=t((Q=((e,s)=>{for(var a in s||(s={}))l.call(s,a)&&n(e,a,s[a]);if(r)for(var a of r(s))o.call(s,a)&&n(e,a,s[a]);return e})({},{name:"PermissionSwitchRole"}),s(Q,a({__name:"index",setup(e){const{t:s}=i(),a=c(),r=u(!1),l=d((()=>a.info)),o=d((()=>[{key:"super",label:s("login.roles.super"),userName:"Super",password:"123456",roles:["R_SUPER"],color:"#E6A23C",description:"拥有系统最高权限，可以访问所有功能模块"},{key:"admin",label:s("login.roles.admin"),userName:"Admin",password:"123456",roles:["R_ADMIN"],color:"#409EFF",description:"拥有管理权限，可以管理用户和部分系统设置"},{key:"user",label:s("login.roles.user"),userName:"User",password:"123456",roles:["R_USER"],color:"#67C23A",description:"普通用户权限，只能访问基础功能模块"}])),n=e=>e&&{R_SUPER:"warning",R_ADMIN:"primary",R_USER:"success"}[e]||"info",t=e=>e&&{R_SUPER:"超级管理员",R_ADMIN:"管理员",R_USER:"普通用户"}[e]||"未知角色",S=e=>{return s=this,l=null,o=function*(){try{r.value=!0;const{token:s,refreshToken:l}=yield g({userName:e.userName,password:e.password});if(!s)throw new Error("Login failed - no token received");a.setToken(s,l);const o=yield N();a.setUserInfo(o),setTimeout((()=>{window.location.reload()}),100)}catch(s){"cancel"!==s&&E.error("切换用户身份失败，请稍后重试")}finally{r.value=!1}},new Promise(((e,a)=>{var r=e=>{try{t(o.next(e))}catch(s){a(s)}},n=e=>{try{t(o.throw(e))}catch(s){a(s)}},t=s=>s.done?e(s.value):Promise.resolve(s.value).then(r,n);t((o=o.apply(s,l)).next())}));var s,l,o};return(e,s)=>{const a=P,i=x,c=O;return v(),p("div",U,[s[7]||(s[7]=m("div",{class:"page-header"},[m("h2",null,"权限切换演示"),m("p",{class:"description"}," 点击下方按钮切换不同用户身份，模拟不同用户登录系统的效果。切换后会影响整个系统的菜单显示和按钮权限。 ")],-1)),m("div",A,[f(i,{shadow:"never"},{header:y((()=>s[0]||(s[0]=[m("div",{class:"card-header"},[m("span",null,"当前登录用户")],-1)]))),default:y((()=>{var e,r;return[m("div",I,[m("div",C,[m("div",D,[s[1]||(s[1]=m("span",{class:"label"},"用户名：",-1)),m("span",M,_(l.value.userName||"未登录"),1)]),m("div",T,[s[2]||(s[2]=m("span",{class:"label"},"角色：",-1)),f(a,{type:n(null==(e=l.value.roles)?void 0:e[0])},{default:y((()=>{var e;return[h(_(t(null==(e=l.value.roles)?void 0:e[0])),1)]})),_:1},8,["type"])]),m("div",F,[s[3]||(s[3]=m("span",{class:"label"},"权限码：",-1)),m("div",z,[(v(!0),p(w,null,j(l.value.buttons,(e=>(v(),k(a,{key:e,size:"small",type:"info",class:"button-tag"},{default:y((()=>[h(_(e),1)])),_:2},1024)))),128)),(null==(r=l.value.buttons)?void 0:r.length)?b("",!0):(v(),p("span",G,"无权限码"))])])])])]})),_:1})]),m("div",L,[f(i,{shadow:"never"},{header:y((()=>s[4]||(s[4]=[m("div",{class:"card-header"},[m("span",null,"账号切换")],-1)]))),default:y((()=>[m("div",H,[(v(!0),p(w,null,j(o.value,(e=>(v(),p("div",{key:e.key,class:R(["role-card",{active:l.value.userName===e.userName}])},[m("div",X,[m("div",q,[m("h4",null,_(e.label),1),m("p",null,_(e.description),1),m("div",B,[m("span",null,"用户名: "+_(e.userName),1),m("span",null,"角色: "+_(e.roles.join(", ")),1)])])]),m("div",J,[l.value.userName!==e.userName?(v(),k(c,{key:0,type:"primary",onClick:s=>S(e),loading:r.value},{default:y((()=>s[5]||(s[5]=[h(" 切换到此角色 ")]))),_:2,__:[5]},1032,["onClick","loading"])):(v(),k(a,{key:1,type:"success"},{default:y((()=>s[6]||(s[6]=[h("当前用户")]))),_:1,__:[6]}))])],2)))),128))])])),_:1})])])}}}))));var Q;const V=S(K,[["__scopeId","data-v-f7e8a4c0"]]);export{V as default};
