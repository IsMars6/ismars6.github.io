var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,i=(e,s)=>{for(var t in s||(s={}))l.call(s,t)&&r(e,t,s[t]);if(a)for(var t of a(s))o.call(s,t)&&r(e,t,s[t]);return e},n=(e,a)=>s(e,t(a));import{d as u,r as d,t as c,a as p,o as m,n as g,b as v,c as f,e as h,f as y,g as x,u as b,h as w,i as _,j as k,k as j,l as M,m as T,p as B,q as E,s as P,v as $,w as L,A as O,x as V,y as I,z as C,B as R,C as S,F as U,D as A,E as D,G as X,H as z,I as N,R as F,J as H,K as q,L as K,M as Y,N as G,O as J,P as W}from"./index-IQGo8WxO.js";import{_ as Q}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as Z}from"./index-ofKD8XxM.js";import{_ as ee}from"./LoginLeftView-DPw0VOm2.js";import{E as se,a as te,b as ae}from"./index-BKZxi3r4.js";import{E as le,a as oe}from"./index-DvdSgfWH.js";import{E as re,a as ie}from"./index-WiBceMwr.js";import{E as ne}from"./index-lwuhUFm2.js";import{E as ue}from"./index-6fZG0U-_.js";import{E as de}from"./index-BKGyGajh.js";import"./index-BnsOyX7d.js";import"./index-DC4nx5T3.js";import"./index-Bi9RLQBv.js";import"./index-CVDCfo3G.js";import"./aria-BWz5Vf1b.js";import"./index-CId84KWp.js";import"./use-form-common-props-AkxMGj96.js";import"./index-CAywqtFc.js";import"./error-D_Dr4eZ1.js";import"./castArray-CEnBrsUU.js";import"./refs-B-58sHkE.js";import"./_baseClone-GChKn-ks.js";import"./_Uint8Array-C6UxRYqY.js";import"./_initCloneObject-9acmKUcz.js";import"./index-CE6ES6Vp.js";import"./token-DWNpOE8r.js";import"./strings-BMKmFQPH.js";import"./isEqual-DovbVL_y.js";import"./use-form-item-M_69vDeD.js";import"./index-jcv93Qxd.js";import"./event-BwRzfsZt.js";import"./scroll-CpQYakkq.js";import"./debounce-Ce2MWZXC.js";import"./_baseIteratee-BI4Nmsbi.js";import"./index-DBDo8sc3.js";import"./vnode-CPGJC5yZ.js";import"./index-BfOxij12.js";import"./index-BI2hd7RK.js";const ce=["innerHTML"],pe=Q(u(n(i({},{name:"ArtDragVerify"}),{__name:"index",props:{value:{type:Boolean,default:!1},width:{default:"100%"},height:{default:40},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:s,emit:t}){const a=t,l=e,o=d({isMoving:!1,x:0,isOk:!1}),{isOk:r}=c(o),i=p(),n=p(),u=p(),B=p();let E,P,$,L;const O=e=>{E=e.targetTouches[0].pageX,P=e.targetTouches[0].pageY},V=e=>{$=e.targetTouches[0].pageX,L=e.targetTouches[0].pageY,Math.abs($-E)>Math.abs(L-P)&&e.preventDefault()};document.addEventListener("touchstart",O),document.addEventListener("touchmove",V,{passive:!1});const I=()=>{var e;return"string"==typeof l.width?(null==(e=i.value)?void 0:e.offsetWidth)||260:l.width};m((()=>{var e;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),g((()=>{var e,s;const t=I();null==(e=i.value)||e.style.setProperty("--width",Math.floor(t/2)+"px"),null==(s=i.value)||s.style.setProperty("--pwidth",-Math.floor(t/2)+"px")})),document.addEventListener("touchstart",O),document.addEventListener("touchmove",V,{passive:!1})})),v((()=>{document.removeEventListener("touchstart",O),document.removeEventListener("touchmove",V)}));const C={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},R=f((()=>({width:"string"==typeof l.width?l.width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius}))),S={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},U=f((()=>({fontSize:l.textSize}))),A=f((()=>l.value?l.successText:l.text)),D=e=>{l.value||(o.isMoving=!0,u.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(u.value.style.left.replace("px",""),10)),a("handlerMove")},X=e=>{if(o.isMoving&&!l.value){const s=I();let t=(e.pageX||e.touches[0].pageX)-o.x;t>0&&t<=s-l.height?(u.value.style.left=t+"px",B.value.style.width=t+l.height/2+"px"):t>s-l.height&&(u.value.style.left=s-l.height+"px",B.value.style.width=s-l.height/2+"px",N())}},z=e=>{if(o.isMoving&&!l.value){const s=I();(e.pageX||e.changedTouches[0].pageX)-o.x<s-l.height?(o.isOk=!0,u.value.style.left="0",u.value.style.transition="all 0.2s",B.value.style.width="0",o.isOk=!1):(u.value.style.transition="none",u.value.style.left=s-l.height+"px",B.value.style.width=s-l.height/2+"px",N()),o.isMoving=!1}},N=()=>{a("update:value",!0),o.isMoving=!1,B.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color="#fff",a("passCallback")};return s({reset:()=>{u.value.style.left="0",B.value.style.width="0",u.value.children[0].innerHTML=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color=l.background,a("update:value",!1),o.isOk=!1,o.isMoving=!1,o.x=0}}),(e,s)=>(y(),h("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:x(b(R)),onMousemove:X,onMouseup:z,onMouseleave:z,onTouchmove:X,onTouchend:z},[w("div",{class:_(["dv_progress_bar",{goFirst2:b(r)}]),ref_key:"progressBar",ref:B,style:S},null,2),w("div",{class:"dv_text",style:x(b(U)),ref_key:"messageRef",ref:n},[e.$slots.textBefore?k(e.$slots,"textBefore",{key:0},void 0,!0):j("",!0),M(" "+T(b(A))+" ",1),e.$slots.textAfter?k(e.$slots,"textAfter",{key:1},void 0,!0):j("",!0)],4),w("div",{class:_(["dv_handler dv_handler_bg",{goFirst:b(r)}]),onMousedown:D,onTouchstart:D,ref_key:"handler",ref:u,style:C},[w("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,ce)],34)],36))}})),[["__scopeId","data-v-293ffbae"]]),me={class:"login"},ge={class:"right-wrap"},ve={class:"top-right-wrap"},fe={class:"iconfont-sys"},he={class:"menu-txt"},ye={key:0,class:"iconfont-sys icon-check"},xe={class:"header"},be={class:"login-wrap"},we={class:"form"},_e={class:"title"},ke={class:"sub-title"},je={class:"drag-verify"},Me={class:"forget-password"},Te={style:{"margin-top":"30px"}},Be={class:"footer"},Ee=Q(u(n(i({},{name:"Login"}),{__name:"index",setup(e){const{t:s}=B(),t=f((()=>[{key:"super",label:s("login.roles.super"),userName:"Super",password:"123456",roles:["R_SUPER"]},{key:"admin",label:s("login.roles.admin"),userName:"Admin",password:"123456",roles:["R_ADMIN"]},{key:"user",label:s("login.roles.user"),userName:"User",password:"123456",roles:["R_USER"]}])),a=E(),{isDark:l}=P(a),o=p(),r=$(),i=L(),n=p(!1),u=p(!1),c=O.systemInfo.name,g=p(),v=d({account:"",username:"",password:"",rememberPassword:!0}),x=f((()=>({username:[{required:!0,message:s("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:s("login.placeholder[1]"),trigger:"blur"}]}))),k=p(!1);m((()=>{Q("super")}));const Q=e=>{var s,a;const l=t.value.find((s=>s.key===e));v.account=e,v.username=null!=(s=null==l?void 0:l.userName)?s:"",v.password=null!=(a=null==l?void 0:l.password)?a:""},ce=()=>{return e=this,s=null,t=function*(){if(g.value)try{if(!(yield g.value.validate()))return;if(!n.value)return void(u.value=!0);k.value=!0;const{username:e,password:s}=v,{token:t,refreshToken:a}=yield K({userName:e,password:s});if(!t)throw new Error("Login failed - no token received");r.setToken(t,a);const l=yield Y();r.setUserInfo(l),r.setLoginStatus(!0),Pe(),i.push("/")}catch(e){e instanceof G||J.error("登录失败，请稍后重试")}finally{k.value=!1,Ee()}},new Promise(((a,l)=>{var o=e=>{try{i(t.next(e))}catch(s){l(s)}},r=e=>{try{i(t.throw(e))}catch(s){l(s)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,r);i((t=t.apply(e,s)).next())}));var e,s,t},Ee=()=>{o.value.reset()},Pe=()=>{setTimeout((()=>{W({title:s("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${s("login.success.message")}, ${c}!`})}),150)},{locale:$e}=B(),Le=e=>{$e.value!==e&&($e.value=e,r.setLanguage(e))};return(e,s)=>{const a=ee,r=te,i=se,d=ae,p=Z,m=ie,f=re,B=le,E=ne,P=pe,$=ue,L=V("RouterLink"),O=de,K=oe,Y=I("ripple");return y(),h("div",me,[C(a),w("div",ge,[w("div",ve,[w("div",{class:"btn theme-btn",onClick:s[0]||(s[0]=(...e)=>b(R)&&b(R)(...e))},[w("i",fe,T(b(l)?"":""),1)]),C(d,{onCommand:Le,"popper-class":"langDropDownStyle"},{dropdown:S((()=>[C(i,null,{default:S((()=>[(y(!0),h(U,null,A(b(D),(e=>(y(),h("div",{key:e.value,class:"lang-btn-item"},[C(r,{command:e.value,class:_({"is-selected":b($e)===e.value})},{default:S((()=>[w("span",he,T(e.label),1),b($e)===e.value?(y(),h("i",ye,"")):j("",!0)])),_:2},1032,["command","class"])])))),128))])),_:1})])),default:S((()=>[s[6]||(s[6]=w("div",{class:"btn language-btn"},[w("i",{class:"iconfont-sys icon-language"},"")],-1))])),_:1,__:[6]})]),w("div",xe,[C(p,{class:"icon"}),w("h1",null,T(b(c)),1)]),w("div",be,[w("div",we,[w("h3",_e,T(e.$t("login.title")),1),w("p",ke,T(e.$t("login.subTitle")),1),C(K,{ref_key:"formRef",ref:g,model:b(v),rules:b(x),onKeyup:q(ce,["enter"]),style:{"margin-top":"25px"}},{default:S((()=>[C(B,{prop:"account"},{default:S((()=>[C(f,{modelValue:b(v).account,"onUpdate:modelValue":s[1]||(s[1]=e=>b(v).account=e),onChange:Q,class:"account-select"},{default:S((()=>[(y(!0),h(U,null,A(b(t),(e=>(y(),X(m,{key:e.key,label:e.label,value:e.key},{default:S((()=>[w("span",null,T(e.label),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),C(B,{prop:"username"},{default:S((()=>[C(E,{placeholder:e.$t("login.placeholder[0]"),modelValue:b(v).username,"onUpdate:modelValue":s[2]||(s[2]=e=>b(v).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),C(B,{prop:"password"},{default:S((()=>[C(E,{placeholder:e.$t("login.placeholder[1]"),modelValue:b(v).password,"onUpdate:modelValue":s[3]||(s[3]=e=>b(v).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off","show-password":""},null,8,["placeholder","modelValue"])])),_:1}),w("div",je,[w("div",{class:_(["drag-verify-content",{error:!b(n)&&b(u)}])},[C(P,{ref_key:"dragVerify",ref:o,value:b(n),"onUpdate:value":s[4]||(s[4]=e=>N(n)?n.value=e:null),text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:b(z)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)"},null,8,["value","text","successText","progressBarBg"])],2),w("p",{class:_(["error-text",{"show-error-text":!b(n)&&b(u)}])},T(e.$t("login.placeholder[2]")),3)]),w("div",Me,[C($,{modelValue:b(v).rememberPassword,"onUpdate:modelValue":s[5]||(s[5]=e=>b(v).rememberPassword=e)},{default:S((()=>[M(T(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),C(L,{to:b(F).ForgetPassword},{default:S((()=>[M(T(e.$t("login.forgetPwd")),1)])),_:1},8,["to"])]),w("div",Te,[H((y(),X(O,{class:"login-btn",type:"primary",onClick:ce,loading:b(k)},{default:S((()=>[M(T(e.$t("login.btnText")),1)])),_:1},8,["loading"])),[[Y]])]),w("div",Be,[w("p",null,[M(T(e.$t("login.noAccount"))+" ",1),C(L,{to:b(F).Register},{default:S((()=>[M(T(e.$t("login.register")),1)])),_:1},8,["to"])])])])),_:1},8,["model","rules"])])])])])}}})),[["__scopeId","data-v-b66c994e"]]);export{Ee as default};
